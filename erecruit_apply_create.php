

<head>
  <meta name="msvalidate.01" content="09A02B8D3F007D4FBAD02C60BEA679F0" />  
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">	
		<title>
			Talener		</title>

			    <meta name="viewport" content="width=device-width">
	
		<link rel="stylesheet" type="text/css" href="http://www.talener.com/wp-content/themes/talener/style.css" media="screen" />
		<link rel="alternate" type="application/rss+xml" title="Talener RSS Feed" href="http://www.talener.com/feed/" />
		<link rel="pingback" href="http://www.talener.com/xmlrpc.php" />
		<link rel="shortcut icon" href="http://www.talener.com/wp-content/themes/talener/images/favicon.ico" type="image/x-icon">
		<link rel="icon" href="http://www.talener.com/wp-content/themes/talener/images/favicon.ico" type="image/x-icon">
		<!--[if lt IE 9]>
		<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js">IE7_PNG_SUFFIX=".png";</script>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]--> 
		
		<script src="http://www.talener.com/wp-content/themes/talener/js/vendor/modernizr-2.6.2.min.js"></script>
		<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
		<link href='http://fonts.googleapis.com/css?family=Muli:400,400italic' rel='stylesheet' type='text/css'>
		<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

<style>
#applynow {
    background-color: grey;
    width: 95%;
	margin-left:10px;
position:relative;
top:150px;
text-align: center;

} 
</style>



   <div id="mobile-menu">
    <div class="menu-mobile-menu-container"><ul id="menu-mobile-menu" class="menu"><li id="menu-item-22017" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-14599 current_page_item menu-item-22017"><a href="http://www.talener.com/">Talener: Your Only IT Staffing Solution</a></li>
<li id="menu-item-22019" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-22019"><a href="http://www.talener.com/candidates/">Candidates</a>
<ul class="sub-menu">
	<li id="menu-item-22020" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22020"><a href="http://www.talener.com/candidates/job-listings/">Job Listings</a></li>
	<li id="menu-item-22021" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22021"><a href="http://www.talener.com/candidates/consultant-resources/">Consultant Resources</a></li>
	<li id="menu-item-22022" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22022"><a href="http://www.talener.com/candidates/tips/">Tips &#038; Tricks</a></li>
</ul>
</li>
<li id="menu-item-22023" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-22023"><a href="http://www.talener.com/about/">Employers</a>
<ul class="sub-menu">
	<li id="menu-item-22024" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22024"><a href="http://www.talener.com/about/team/">Team</a></li>
	<li id="menu-item-22025" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22025"><a href="http://www.talener.com/about/testimonials/">Testimonials</a></li>
	<li id="menu-item-22026" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22026"><a href="http://www.talener.com/about/work-at-talener/">Work at Talener</a></li>
</ul>
</li>
<li id="menu-item-22018" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22018"><a href="http://www.talener.com/blog/">Blog</a></li>
<li id="menu-item-22027" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-22027"><a href="http://www.talener.com/contact/">Contact</a></li>
</ul></div>    <a class="mobile-close">Close</a>
    </div>
    <div class="header">
	    <div class="top-head">
	    	<div class="inner">
	    		<div class="tag">
		    	<i>Where Technology Meets Staffing</i>
		    	</div>
		    	
		    	<ul class="social-top">
		    		<li class="fb"><a href="http://www.facebook.com/pages/Talener-Group-NYC/130014800351250" target="_blank">Facebook</a></li>
		    		<li class="tw"><a href="http://twitter.com/talenerHQ" target="_blank">Twitter</a></li>
		    		<li class="li"><a href="http://www.linkedin.com/company/talener" target="_blank">LinkedIn</a></li>
		    		<li class="gp"><a href="https://plus.google.com/101510089960110340450/" target="_blank">Google+</a></li>
		    	</ul>
		    	
		    	<div class="header-call">
		    	<span>Call us anytime: </span>1-917-720-1080
		    	</div>
	    	</div>
	    </div>
	    <div class="nav">
	    	<div class="inner">
	    		<a href="http://www.talener.com"><h1>Talener</h1></a>
	    		<div class="menu-primary-menu-container"><ul id="menu-primary-menu" class="menu"><li id="menu-item-14598" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14598"><a href="http://www.talener.com/candidates/">Candidates</a></li>
<li id="menu-item-14597" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14597"><a href="http://www.talener.com/employers/">Employers</a></li>
<li id="menu-item-14596" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14596"><a href="http://www.talener.com/about/">About Us</a></li>
<li id="menu-item-14595" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14595"><a href="http://www.talener.com/blog/">Blog</a></li>
<li id="menu-item-14594" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-14594"><a href="http://www.talener.com/contact/">Contact</a></li>
</ul></div>	    		<a class="mobile-menu-trigger">Menu</a>
	    	</div>
	    </div>
    </div>
<div id="applynow">

<?php

echo 'Do not refresh or close your browser window...    ';

#Talener erecruit API intergration authored by Mario Moorhead Blackskymedia 2014 

##Settings
$serviceRoot = "http://erecruit.talener.com/restservices";
$entityID = "00000000-0000-0000-0000-000000000E01";
$username = "API@talener.com";
$password = "Pass123";
##End Settings


	
$createdByID = 'e137632b-ae1c-402b-8063-0afabe461361';


// log on to RESTful service get CreatedByID and set cookie
$c = authenticate($serviceRoot, $username, $password, $entityID);


$newCandidate = array();
$newCandidate = $_REQUEST;

$candiate = $_REQUEST['Email'];
//echo 'CANDIATE = '.$Candidate;

if ($goodvibes == 'appl1') {

	//echo $cid;

	$candidateID = $cID;
	$positionID = 8166;
	$createdByID = 'e137632b-ae1c-402b-8063-0afabe461361';
	//$entityID = 'xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx';
	//$entityID = "00000000-0000-0000-0000-000000000";


	//echo 'EntityID '.$entityID.' ';

	// createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID)
	  $foo = createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID);
	echo 'APPLICATION SENT! ';


	// $checker = '1000|';
	// $statusCheck = strpos($foo, $checker);
	// //var_dump($foo);
	// echo 'LIVE OUTPUT '.$foo;

	// if ($statusCheck === true)
	// 	echo ' NAILED IT ';
}

if ($_REQUEST == null)	{
	echo '<html>
	<body>

	<form action="erecruit_apply1.php" enctype="multipart/form-data" method="post">
	      <fieldset>
	        <legend>We could not find you in the system, please fill in fields to create an erecruit account</legend>

				
					<div class="item">
						<h5>FirstName</h5>
						<input id="FirstName" name="FirstName" type="text" value="" />
					</div>

					<div class="item">
						<h5>MiddleName</h5>
						<input id="MiddleName" name="MiddleName" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>LastName</h5>
						<input id="LastName" name="LastName" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>NickName</h5>
						<input id="NickName" name="NickName" type="text" value="" />
					</div>

	                <div class="item">
	                    <h5>Title</h5>
	                    <input id="Title" name="Title" type="text" value="" />
	                </div>
					
					<div class="item">
						<h5>Email</h5>
						<input id="Email" name="Email" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>AddressLine1</h5>
						<input id="AddressLine1" name="AddressLine1" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>City</h5>
						<input id="City" name="City" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>StateID</h5>
						<input data-val="true" data-val-number="The field StateID must be a number." id="StateID" name="StateID" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>PostalCode</h5>
						<input id="PostalCode" name="PostalCode" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>CountryID</h5>
						<input data-val="true" data-val-number="The field CountryID must be a number." data-val-required="The CountryID field is required." id="CountryID" name="CountryID" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>HomePhone</h5>
						<input id="HomePhone" name="HomePhone" type="text" value="" />
					</div>
					
					<div class="item">
						<h5>MobilePhone</h5>
						<input id="MobilePhone" name="MobilePhone" type="text" value="" />
					</div>
					
					<div class="item">
						<input id="AdSource" name="AdSource" type="hidden" value="none" />
					</div>
					
					<div class="item">
						
						<input id="FolderGroupID" name="FolderGroupID" type="hidden" value="3" />
					</div>

	        <h5 style="clear: both; margin-top: 10px;">&nbsp;</h5>
	       
					<input type="submit" value="Add Candidate" />
	      </fieldset>
	    </form>





	</body>
	</html>';
}

















if ($_REQUEST != NULL)
{

//$create_candidate = array();

$candidateData = array();
$candidateData[FirstName] = $_REQUEST["FirstName"];
$candidateData[MiddleName] = $_REQUEST["MiddleName"];
$candidateData[LastName] = $_REQUEST["LastName"];
$candidateData[Email] = $_REQUEST["Email"];

$candidateData[AddressLine1] = $_REQUEST["AddressLine1"];
$candidateData[City] = $_REQUEST["City"];
$candidateData[State] = $_REQUEST["State"];
$candidateData[NickName] = $_REQUEST["NickName"];
$candidateData[] = $_REQUEST["NickName"];

$foo = createCandidate($c, $serviceRoot, $candidateData, $createdByID);



$Candidate = $_REQUEST["Email"];

if ($candiate != null && $candiate != '') {
	$results2 = findCandidate($c, $serviceRoot, $candiate, $entityID);
	//echo 'this works---> '.$candiate.' ';

	/**
	 * here we have the result in a string it is not xml and needs to be parsed
	 **/
	$jobLisiting = array();
	$p = xml_parser_create();
	xml_parse_into_struct($p, $results2, $vals, $index);
	xml_parser_free($p);


//	$record = 1;

//	for ($i=0; $i < 280; $i++) { 
		
//		if($vals[$i] == null)
//			break;

//		if($vals[$i]['tag'] == 'CANDIDATEID'){
//			$candidateID = $vals[$i]['value'];
//			echo 'Candidate ID '.$cID;
//			$goodvibes = 1;
//		}
	
//	}

}



//$foo = createCandidate($c, $serviceRoot, $candidateData, $createdByID);

//$foo = createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID, $create_candidate);	

//var_dump($foo);
$positionID = $_REQUEST["PositionID"];

  $foo = createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID);
	echo 'Your Application has been sent.  Good luck :)';





}

//$candidateData = array();

//$candidateData = array(
//"Title" => "mario Moorhead",
//"CreatedByID" => "11"
//);

//$apply = createCandidate($c, $serviceRoot, $candidateData);


//$candy = getCandidate($c, $serviceRoot, $candidateID, $entityID);

//var_dump($apply);





//$pippy = createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID);

//var_dump($pippy);






## Returns an authorized curl resource that can be used with subsequent requests
function authenticate($serviceRoot, $username, $password, $entityID)
{
	$authenticate = $serviceRoot . "/Authenticate";
	
	$c = curl_init();
	
	curl_setopt($c, CURLOPT_URL, $authenticate);
	curl_setopt($c, CURLOPT_POST, true);
	curl_setopt($c, CURLOPT_RETURNTRANSFER, true);
	curl_setopt($c, CURLOPT_HEADER, true);
	curl_setopt($c, CURLINFO_HEADER_OUT, true);
	curl_setopt($c, CURLOPT_COOKIEFILE, 'cookie.txt');
	curl_setopt($c, CURLOPT_SSL_VERIFYPEER, false);
	curl_setopt($c, CURLOPT_VERBOSE, true);
	curl_setopt($c, CURLOPT_COOKIEJAR, 'cookie.txt');
	
	curl_setopt($c, CURLOPT_NOPROGRESS, true);
	
	$data = array('Username' => $username, 'Password' => $password, 'EntityID' => $entityID);
	curl_setopt($c, CURLOPT_POSTFIELDS, $data);
		
	$result = curl_exec($c);
//	var_dump($result);
	return $c;
}

function getCandidate($c, $serviceRoot, $candidateID, $entityID)
{
	$url = "$serviceRoot/Candidate/$entityID/$candidateID";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_HTTPGET, true);
	
	$result = curl_exec($c);
	echo 'PROBLEM HERE ';
	//var_dump(curl_getinfo($c, CURLINFO_HEADER_OUT));
	return $result;
}


function createCandidate($c, $serviceRoot, $candidateData)
{
	$url = "$serviceRoot/Candidate/Do/Create";
	$CreatedByID = 'e137632b-ae1c-402b-8063-0afabe461361';
	$entityID = "00000000-0000-0000-0000-000000000E01";

	//var_dump($candidateData);
	//echo 'RIGHT HERE ';


	$candidateData = array(
	 "FirstName" => $candidateData['FirstName'],
	 "NickName" => $candidateData['NickName'],
	 "LastName" => $candidateData['LastName'], 
	 "Email" => $candidateData['Email'],
	 "AdSource" => "Other",
	 "EntityID" => $entityID,
	 "FolderGroupID" => 1,
	 "CreatedByID" => $CreatedByID,
	 "AddressLine1" => $candidateData['AddressLine1'],
	 "AddressLine2" => "",
	 "City" => $candidateData['City'],
	 "State" => $candidateData['State'],
	 "Country" => "US",
	 "IsApproved" => "True",
	 "Password" => "Pass123",
	 "WithPermissions" => "True",
	 "Resume" => "http://blackskymedia.com/test.pdf",
	 "OwnerID" => $CreatedByID,
	 "Ethnicity" => "Hispanic, Latino, or Spanish"
	);


	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_POST, true);
	//curl_setopt($c, CURLOPT_POSTFIELDS, $CreatedByID);
	curl_setopt($c, CURLOPT_POSTFIELDS, $candidateData);
	
	$result = curl_exec($c);
	
	return $result;
}

function updateCandidate($c, $serviceRoot, $entityID, $candidateID, $candidateData)
{
	$url = "$serviceRoot/Candidate/$entityID/$candidateID/Update";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_POST, true);
	
	curl_setopt($c, CURLOPT_POSTFIELDS, $candidateData);
	
	$result = curl_exec($c);
	
	return $result;
}

function findCandidate($c, $serviceRoot, $candiate, $entityID)
{
	//echo 'more';
	$url = "$serviceRoot/User/$entityID/$candiate";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_HTTPGET, true);
	curl_setopt($c, CURLOPT_HEADER, false);
	
	$result = curl_exec($c);
	//echo 'found candiate '.$result;
	//var_dump($result);
	//echo 'food';
	//print_r($result);
	//echo 'more';
	return $result;
}

function uploadAttachment($c, $serviceRoot, $attachmentData)
{
	$url = "$serviceRoot/Attachment/Do/UploadAttachment";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_POST, true);
		
	curl_setopt($c, CURLOPT_POSTFIELDS, $attachmentData);
	
	$result = curl_exec($c);
	return $result;
}

function uploadResume($c, $serviceRoot, $candidateID, $entityID, $resumeData)
{
	$url = "$serviceRoot/Candidate/$entityID/$candidateID/UploadResume";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_POST, true);
	
	curl_setopt($c, CURLOPT_POSTFIELDS, $resumeData);
	
	$result = curl_exec($c);
	return $result;
}

function createApplication($c, $serviceRoot, $entityID, $createdByID, $candidateID, $positionID)
{
	$url = "$serviceRoot/CandidateApplication/$entityID/Do/Create";
	
	curl_setopt($c, CURLOPT_URL, $url);
	curl_setopt($c, CURLOPT_POST, true);
	
	curl_setopt($c, CURLOPT_POSTFIELDS, array(
			"CreatedByID" => $createdByID,
			"PositionID" => $positionID,
			"CandidateID" => $candidateID,
			"ApplicationSource" => 'spoonface',
			"EntityID" => $entityID));
			
	$result = curl_exec($c);
	//var_dump($result);
	return $result;
}

$r = authenticate($serviceRoot, $username, $password, $entityID);
//var_dump($r[1]);

if ($create_candidate)
{
	echo 'HOOOOOOPPPPPPEEEE ';
	$n = rand(1, 10000);
	$candidateData = array(
	 "FirstName" => "erecruit Test",
	 "NickName" => "",
	 "LastName" => "Candidate " . $n, 
	 "Email" => "testcandidate" . $n . "@erecruit.com",
	 "AdSource" => "Other",
	 "EntityID" => $entityID,
	 "FolderGroupID" => 1,
	 "CreatedByID" => '6E5AB85A-B786-42DE-B7A8-3DACD28957C2',
	 "AddressLine1" => "100 Main St",
	 "AddressLine2" => "Apt 2",
	 "City" => "Chicago",
	 "State" => "Illinois",
	 "Country" => "US",
	 "IsApproved" => "True",
	 "Password" => "test123",
	 "WithPermissions" => "True",
	 "Resume" => "@C:/Projects/php/erecruit/sampledoc.rtf",
	 "Gender" => "M",
	 "Ethnicity" => "Hispanic, Latino, or Spanish"
	);

	$result = createCandidate($r[0], $serviceRoot, $candidateData);
//	var_dump($result);

	$x = new SimpleXMLElement($result);
//	var_dump($x->Data->Message);
	$refID = $x->Data->Message;

	if ($x->Status == 0) return;

	$result = getCandidate($r[0], $serviceRoot, $x->Data->Message, $entityID);
//	var_dump($result);

	$x = new SimpleXMLElement($result);
//	var_dump($x->Data->Candidate->UserID);
}

if ($create_application)
{
	$result = createApplication($r[0], $serviceRoot, $entityID, '6E5AB85A-B786-42DE-B7A8-3DACD28957C2', $candidateID, $applicationPositionID);
//echo 'POOPY TIME ';
//	var_dump($result);
}

if ($update_candidate)
{
 $updateCandidateData = array(
	 "EthnicityID" => "200",
	 "ChangedByID" => "6E5AB85A-B786-42DE-B7A8-3DACD28957C2"
 );
 
 $result = updateCandidate($r[0], $serviceRoot, $entityID, $candidateID, $updateCandidateData);
 //var_dump($result);
}
// curl_close($r[0]);

?>
<script>
function goBack() {
    window.history.go(-3)
}
</script>
<div>
<button onclick="goBack()">Back to jobs</button>
</div>
</div>
